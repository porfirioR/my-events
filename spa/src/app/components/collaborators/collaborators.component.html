<!-- Collaborators List Section -->
<section aria-labelledby="collaborators-heading" class="mb-8">
  <article class="bg-base-200 dark:bg-base-300 rounded-xl shadow-lg hover:shadow-xl overflow-hidden transition-all duration-300">
    <header class="px-6 py-4 border-b border-base-300 dark:border-base-100">
      <div class="flex items-center justify-between">
        <h2 id="collaborators-heading" class="text-xl font-semibold text-base-content">Collaborators</h2>
        <button
          class="text-primary hover:text-primary-focus text-sm font-medium px-3 py-1 rounded-md hover:bg-primary/10 transition-colors"
          (click)="create()"
        >
          Add New
        </button>
      </div>
    </header>

    <div class="p-6">
      <ul class="space-y-4" role="list">
        <!-- Collaborator Item -->
        @for (collaborator of collaborators; track collaborator.id) {
          <li class="bg-base-100 dark:bg-base-200 rounded-lg p-4 hover:bg-base-300/50 dark:hover:bg-base-100/50 transition-colors duration-200">
            <article class="flex items-center">
              <!-- Avatar Section -->
              <figure class="flex-shrink-0 mr-4">
                <div
                  class="w-12 h-12 rounded-full flex items-center justify-center text-white font-semibold text-sm shadow-md"
                  [ngClass]="{
                    'bg-blue-500 dark:bg-blue-600': collaborator.type === 'INTERNAL',
                    'bg-purple-500 dark:bg-purple-600': collaborator.type === 'EXTERNAL'
                  }"
                >
                  {{ getInitials(collaborator.name, collaborator.surname) }}
                </div>
              </figure>
              <!-- Collaborator Info -->
              <div class="flex-grow min-w-0">
                <header>
                  <h3 class="font-semibold text-base-content truncate">
                    {{ collaborator.name }} {{ collaborator.surname }}
                  </h3>
                  <p class="text-sm text-base-content/70">
                    @if (collaborator.email) {
                      {{ collaborator.email }}
                    } @else {
                      No email provided
                    }
                  </p>
                  <time [attr.datetime]="collaborator.createdDate.toISOString()" class="text-xs text-base-content/60">
                    Joined {{ getFormattedDate(collaborator.createdDate) }}
                  </time>
                </header>
                <!-- Status and Type Badges -->
                <div class="flex items-center mt-2 space-x-2">
                  <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium border"
                    [ngClass]="{
                      'bg-success/20 text-success border-success/30': collaborator.isActive,
                      'bg-error/20 text-error border-error/30': !collaborator.isActive
                    }"
                  >
                    <i class="fas mr-1"
                      [ngClass]="{
                        'fa-check-circle': collaborator.isActive,
                        'fa-times-circle': !collaborator.isActive
                      }"
                      aria-hidden="true"
                    ></i>
                    {{ collaborator.isActive ? 'Active' : 'Inactive' }}
                  </span>
                  <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium"
                    [ngClass]="{
                      'bg-primary/20 text-primary border border-primary/30': collaborator.type === 'INTERNAL',
                      'bg-secondary/20 text-secondary border border-secondary/30': collaborator.type === 'EXTERNAL'
                    }"
                  >
                    <i class="fas mr-1"
                      [ngClass]="{
                        'fa-building': collaborator.type === 'INTERNAL',
                        'fa-users': collaborator.type === 'EXTERNAL'
                      }" aria-hidden="true"
                    ></i>
                    {{ collaborator.type | titlecase }}
                  </span>
                </div>
              </div>
              <!-- Actions Menu -->
              <aside class="text-right ml-4">
                <details class="dropdown dropdown-end">
                  <summary tabindex="0" role="button"
                    class="btn btn-ghost btn-sm btn-circle hover:bg-base-content/10 transition-colors"
                    [attr.aria-label]="'Actions for ' + collaborator.name + ' ' + collaborator.surname">
                    <i class="fas fa-ellipsis-v text-base-content/70" aria-hidden="true"></i>
                  </summary>
                  <nav
                    class="dropdown-content z-[1] menu p-2 shadow-lg bg-base-100 dark:bg-base-200 rounded-lg w-52 border border-base-300 dark:border-base-100"
                    role="menu" [attr.aria-label]="'Action menu for ' + collaborator.name"
                  >
                    <ul role="menubar" class="space-y-1">
                      <!-- Edit Action -->
                      <li role="none">
                        <button type="button" (click)="editCollaborator(collaborator)" role="menuitem"
                          class="w-full text-left flex items-center px-3 py-2 text-sm rounded-md hover:bg-primary/10 hover:text-primary transition-colors">
                          <i class="fas fa-edit mr-3 text-primary" aria-hidden="true"></i>
                          <span>Edit</span>
                        </button>
                      </li>
                      <!-- Toggle Status Action -->
                      <li role="none">
                        <button type="button" (click)="toggleCollaboratorStatus(collaborator)" role="menuitem"
                          class="w-full text-left flex items-center px-3 py-2 text-sm rounded-md transition-colors"
                          [ngClass]="{
                            'hover:bg-warning/10 hover:text-warning': collaborator.isActive,
                            'hover:bg-success/10 hover:text-success': !collaborator.isActive
                          }"
                        >
                          <i class="fas mr-3"
                            [ngClass]="{
                              'fa-pause text-warning': collaborator.isActive,
                              'fa-play text-success': !collaborator.isActive
                            }"
                            aria-hidden="true"
                          ></i>
                          <span>{{ collaborator.isActive ? 'Deactivate' : 'Activate' }}</span>
                        </button>
                      </li>
                      <!-- Statistics Action -->
                      <li role="none">
                        <button type="button" (click)="viewCollaboratorStats(collaborator)" role="menuitem"
                          class="w-full text-left flex items-center px-3 py-2 text-sm rounded-md hover:bg-info/10 hover:text-info transition-colors">
                          <i class="fas fa-chart-bar mr-3 text-info" aria-hidden="true"></i>
                          <span>Statistics</span>
                        </button>
                      </li>
                      <hr class="divider my-1" role="separator" aria-orientation="horizontal">
                      <!-- Delete Action -->
                      <li role="none">
                        <button type="button" (click)="deleteCollaborator(collaborator)" role="menuitem"
                          class="w-full text-left flex items-center px-3 py-2 text-sm rounded-md hover:bg-error/10 hover:text-error transition-colors">
                          <i class="fas fa-trash mr-3 text-error" aria-hidden="true"></i>
                          <span>Delete</span>
                        </button>
                      </li>
                    </ul>
                  </nav>
                </details>
              </aside>
            </article>
          </li>
        }

        <!-- Empty State -->
        @if (collaborators.length === 0) {
          <li class="text-center py-12">
            <figure class="mx-auto w-16 h-16 bg-base-content/10 rounded-full flex items-center justify-center mb-4">
              <i class="fas fa-users text-2xl text-base-content/50" aria-hidden="true"></i>
            </figure>
            <h3 class="text-lg font-medium text-base-content mb-2">No collaborators yet</h3>
            <p class="text-base-content/70 mb-4">Get started by adding your first collaborator</p>
            <button class="btn btn-primary" [routerLink]="['create']">
              <i class="fas fa-plus mr-2" aria-hidden="true"></i>
              Add Collaborator
            </button>
          </li>
        }
      </ul>

      <!-- Pagination (if needed) -->
        @if (collaborators.length > 0) {
          <footer class="mt-6 flex items-center justify-between">
            <p class="text-sm text-base-content/70">
              Showing {{ collaborators.length }} of {{ totalCollaborators }} collaborators
            </p>
            @if (totalPages > 1) {
              <div class="flex space-x-2">
                <button class="btn btn-sm btn-outline" [disabled]="currentPage === 1" (click)="previousPage()">
                  <i class="fas fa-chevron-left" aria-hidden="true"></i>
                </button>
                <span class="flex items-center px-3 py-1 text-sm text-base-content/70">
                  {{ currentPage }} of {{ totalPages }}
                </span>
                <button class="btn btn-sm btn-outline" [disabled]="currentPage === totalPages" (click)="nextPage()">
                  <i class="fas fa-chevron-right" aria-hidden="true"></i>
                </button>
              </div>
            }
          </footer>
        }
    </div>
  </article>
</section>