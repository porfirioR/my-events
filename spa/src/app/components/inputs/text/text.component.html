<fieldset [ngClass]="(ngControl.control?.invalid && ngControl.control?.touched) || description ? 'mb-0': 'mb-6'">
  <label
    class="label cursor-pointer justify-start p-0 pb-2" 
    [for]="name"
  >
    <span class="label-text text-base-content font-medium text-sm transition-colors duration-200 dark:text-white">
      {{label}}
    </span>
  </label>
  <div class="relative">
    <input
      [id]="id"
      [name]="name"
      [attr.aria-label]="label"
      [placeholder]="placeholder || label"
      [type]="type === 'password' ? passwordFieldType : type"
      [title]="description"
      [autocomplete]="autocomplete || type === 'password' ? 'on': 'off'"
      [formControl]="$any(ngControl).control"
      [disabled]="disabled"
      [step]="type=== 'number' ? 1 : null"
      class="px-3 py-2 bg-white border shadow-sm border-slate-300 placeholder-slate-400 disabled:bg-slate-50 disabled:text-slate-500 disabled:border-slate-200 focus:outline-none focus:border-indigo-500 focus:ring-indigo-500 block w-full rounded-md sm:text-sm focus:ring-1 transition-colors duration-200 dark:bg-gray-800 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-indigo-500 dark:focus:border-indigo-500"
      [ngClass]="{
        'pr-10': type === 'password',
        'border-red-500 focus:border-red-500 focus:ring-2 focus:ring-red-500/20 text-red-600 dark:border-red-400 dark:text-red-400 dark:focus:border-red-400 dark:focus:ring-red-400/20': 
          ngControl.control?.invalid && ngControl.control?.touched,
        'border-slate-300 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-500/20 hover:border-slate-400 dark:border-gray-600 dark:hover:border-gray-500 dark:focus:border-indigo-500 dark:focus:ring-indigo-500/20': 
          !ngControl.control?.invalid || !ngControl.control?.touched
      }"
    />
    @if (type === 'password' && id != 'repeatPassword') {
      <button
        type="button"
        class="cursor-pointer absolute inset-y-0 right-0 pr-3 flex items-center text-slate-400 hover:text-slate-600 transition-colors duration-200 dark:text-gray-400 dark:hover:text-gray-200"
        (click)="togglePasswordVisibility()"
        [attr.aria-label]="passwordFieldType === 'password' ? 'Show password' : 'Hide password'"
      >
        <i 
          class="fas transition-all duration-200 text-sm"
          [ngClass]="passwordFieldType === 'password' ? 'fa-eye' : 'fa-eye-slash'"
        ></i>
      </button>
    }
  </div>
  @if (description && !(ngControl.control?.touched && ngControl.control?.errors)) {
    <div class="mt-2">
      <span class="text-base-content/70 text-xs italic flex items-center gap-1 transition-colors duration-200 dark:text-gray-400">
        <i class="fas fa-info-circle text-info text-xs"></i>
        {{description}}
      </span>
    </div>
  }
  <app-form-errors [formControl]="$any(ngControl).control" [label]="label"/>
</fieldset>